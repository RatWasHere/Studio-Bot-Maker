<html>
  <link rel="stylesheet" href="main.css" />
  <meta charset="utf8" />
  <div class="titlebar flexbox textToLeft">
    
    <div style="background-size: cover; background-image: url('./icon.png'); height: 3vh; width: 3vh; margin-top: auto; margin-bottom: auto; margin-left: 1vw !important; margin-right: 1vw !important;"></div>

  <div id="titlebar" style="margin-top: auto; margin-bottom: auto;">Studio bot maker +</div>
  <div style="height: 40%; margin: auto; margin-right: 1vw; margin-left: 1vw; width: 3px; background-color: #FFFFFF40; border-radius: 12px;"></div>

  <div class="hoverablez option" onclick="initSetup()" style="margin-left: 0px">Settings</div>
  <div class="hoverablez option nmt">Project
    <div class="optionPopup dimension">
      <div class="hoverablez"  onclick="ipcRenderer.send('export', botData)">Export project</div>
      <div class="hoverablez"  onclick="sltPrj()">Import project</div>
    </div>
    
  </div>
  <div class="hoverablez option">Bot

    <div class="optionPopup dimension">
      <div class="hoverablez flexbox" onclick="toggleBotStatus()"><div id="turnBotOn">Turn bot online</div> <div style="margin-left: auto; opacity: 50%;">CTRL + Q</div></div>
      <div class="hoverablez" onclick="if (!isBotOn) {ipcRenderer.send('runBot')}; ipcRenderer.send('openBotWindow')">Bot runner logs</div>
    </div>
  </div>

  <div style="margin: auto; margin-left: 1vw; margin-right: 1vw;" id="botStatus">Your bot is offline</div>
  
  <div class="hoverablez option flexbox" onclick="ipcRenderer.send('minimize')" style="height: 100%; width: 50px; padding: 0px; margin-top: auto; margin-bottom: auto; margin-left: auto; border-radius: 0px; margin-right: 0px; border-top-left-radius: 8px; border-bottom-left-radius: 8px;"><div style="width: 30%; border: 4px #FFFFFF50 solid; margin: auto; border-radius: 3px;"></div></div>
  <div class="hoverablez option flexbox" onclick="ipcRenderer.send('maximize')" style="height: 100%; width: 50px; padding: 0px; margin-top: auto; margin-bottom: auto; border-radius: 0px; margin-left: 0px; margin-right: 0px;"><div style="height: 30%; aspect-ratio: 1/1; border: 5px #FFFFFF50 solid; margin: auto; border-radius: 3px;"></div></div>
  <div class="hoverablez option flexbox" onclick="ipcRenderer.send('close')" style="height: 100%; width: 50px; padding: 0px; margin-top: auto; margin-bottom: auto; border-radius: 0px; margin-left: 0px;"><div class="image add" style="margin: auto; rotate: 45deg;"></div></div>
  <div style="height: 100%;"></div>
  </div>
  
  <div
    style="
      justify-content: center;
      width: 100%;
      align-content: center;
      margin-left: auto;
      margin-right: auto;
      align-items: center;
      justify-items: center;
      overflow-y: none !important;
    "
  >
    <div class="flexbox fbh">
      <div style="flex: none; width: 48.3vw">
        <div id="animationArea">
          <div
            class="actBarHalf actbartop"
            id="commandbar"
            style="z-index: 2"
          ></div>
          <div
            class="actbartoolbar flexbox actbarbottom"
            style="
              margin-bottom: 1vh;
              align-items: center;
              justify-content: center;
            "
          >
            <div style="margin-right: auto; margin-left: 1vw">
              <div class="barbuttontexta" id="groupTypes">Groups</div>
            </div>
            <div
              style="margin-left: auto; margin-right: 1vw"
              class="flexbox"
              style="align-items: center; justify-content: center"
            >
              <div
                class="barbuttone"
                onclick="lastType = 0; newObject();"
                style="width: 2.7vw; height: 3vh"
              >
                <div class="image add"></div>
              </div>
            </div>
          </div>
          <div
            class="actBarHalf actbartop"
            id="actionbar"
            style="width: 98.6vw !important"
          ></div>
          <div
            class="actbartoolbar flexbox actbarbottom"
            style="
              align-items: center;
              justify-content: center;
              width: calc(98.6vw - 4px) !important;
            "
          >
            <div style="margin-right: auto; margin-left: 1vw">
              <div class="barbuttontexta" id="actionsOf">Actions of</div>
            </div>

            <div
              style="margin-left: auto; margin-right: 1vw"
              class="flexbox"
              style="align-items: center; justify-content: center"
            >
              <div
                class="barbuttone borderrightz"
                onclick="lastType = 1; editAction(document.getElementById('Action' + lastAct));"
                style="width: 2.7vw; height: 3vh"
              >
                <div class="imagefull editAction"></div>
              </div>
              <div
                class="barbuttone borderleftz"
                onclick="lastType = 1; newObject();"
                style="
                  width: 2.7vw;
                  height: 3vh;
                  margin-left: 0.12vw;
                  margin-right: 0.12vw;
                "
              >
                <div class="image add"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="edutor" class="fullsize" style="height: 42vh !important">
        <div id="animationEditor">
          <div
            class="flexbox tile dimension noanims"
            style="
              margin-bottom: 0.5vh;
              height: calc(5vh - 10px) !important;
              padding: 0px !important;
              padding-top: 5px !important;
              padding-bottom: 5px !important;
              width: 100%;
              border-radius: 12px;
            "
          >
            <div
              class="barbuttonshift borderright"
              id="highlightedGroup1"
              style="width: calc(34.5% - 24px); padding: 0px; height: 100%"
              onclick="setHighlightedGroup(1)"
            >
              <div class="barbuttontexta">Text commands</div>
            </div>
            <div
              class="barbuttonshift bordercenter"
              id="highlightedGroup2"
              style="width: calc(34.5% - 24px); padding: 0px; height: 100%"
              onclick="setHighlightedGroup(2)"
            >
              <div class="barbuttontexta">Slash commands</div>
            </div>
            <div
              class="barbuttonshift borderleft"
              id="highlightedGroup3"
              style="width: calc(34.5% - 24px); padding: 0px; height: 100%"
              onclick="setHighlightedGroup(3)"
            >
              <div class="barbuttontexta">Events</div>
            </div>
          </div>
          <div
            class="tile borderbottomz"
            style="background: linear-gradient(0deg, #ffffff10, #ffffff15); padding: 0px; width: 100%; padding-top: 12px; padding-bottom: 12px;"
          >
            <btext style="width: 90%; margin-left: 2%;"><span id="groupType">-</span> name</btext>
            <div
              class="inputBar"
              contenteditable="true"
              id="Command_Name"
              oninput="validateInputSpaces(this); updateName(this)"
            ></div>
          </div>

          <div
            class="tile bordercentere"
            style="
              background: linear-gradient(0deg, #ffffff15, #ffffff10);
              margin-top: 0px;
              padding: 0px; width: 100%; padding-top: 12px; padding-bottom: 12px;
            "
          >
            <div
              id="botData.commands[lastObj].actions"
              class="baction noanims"
              style="
                width: 95%;
                padding: 4px;
                margin-top: 0px;
                margin-bottom: 10px;
                border-radius: 9px;
              "
            >
              Using 0 actions
            </div>
            <div class="flexbox" id="groupActionsContainer" style="height: 33px; transition: all 0.2s ease; overflow-x: auto;">
              <div
                class="baction noanims hoverable optionleft flexbox"
                style="align-items: center; justify-content: center; padding: 0px; width: 100%; padding-top: 12px; padding-bottom: 12px;"
                id="commandParameters"
                onclick="openParameters()"
              >
                <div style="margin-right: auto; margin-left: 1vw">
                  Parameters
                </div>
                <div class="image openExternally"></div>
              </div>
              <div
                class="baction noanims hoverable optionright flexbox"
                style="
                  overflow: auto;
                  align-items: center;
                  justify-content: center;
                "
                id="groupEvents"
                onclick="openEvent()"
              >
                <div style="margin-right: auto; margin-left: 1vw">Event:</div>
                <div class="image openExternally"></div>
              </div>
              <div
                class="baction noanims hoverable optionright flexbox"
                style="align-items: center; justify-content: center"
                id="commandOptions"
                onclick="openPermissionEditor()"
              >
                <div style="margin-right: auto; margin-left: 1vw">
                  Permissions
                </div>
                <div class="image openExternally"></div>
              </div>
            </div>
          </div>
          <div class="tile bordertop any">
            <div
              class="flexbox"
              style="
                align-items: center;
                justify-content: center;
                margin-left: auto;
                margin-right: auto;
              "
            >
              <div
                class="dimension hoverablez flexbox"
                id="colorToggler"
                onclick="toggleColorsVisibility(this)"
                style="
                  margin-right: 0.5vw;
                  aspect-ratio: 1/1;
                  height: calc(4vh + 10px);
                  border-radius: 12px;
                  cursor: pointer;
                  margin-left: auto;
                  transition: all 0.3s cubic-bezier(0.47, 1.64, 0.41, 0.8);
                "
              >
                <div class="image editAction"></div>
              </div>
              <div
                class="flexbox dimension"
                id="colorsSelector"
                style="
                  overflow-x: auto;
                  overflow-y: none;
                  height: 4vh;
                  width: 85%;
                  margin-right: auto;
                  margin-left: auto;
                  padding: 0px;
                  border-radius: 12px;
                  background-color: #ffffff10;
                  transition:
                    all 0.25s ease,
                    padding 0.1s ease,
                    width 0.25s ease;
                "
              >
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(null)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #ffffff;
                    opacity: 10%;
                    height: 4vh;
                    border-radius: 100vw;
                    transform: scale(0.7);
                    margin-left: 0.3vw;
                    margin-right: 0.3vw;
                    margin-top: auto;
                    margin-bottom: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #ffffff;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #f54242;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #f58d42;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #f5da42;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #9ef542;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #4bf542;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #42f59e;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #42f5f5;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #42a4f5;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #4251f5;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #aa42f5;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #f542ce;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
                <div
                  class="dimension coloredTile"
                  onclick="setGroupColor(this)"
                  style="
                    aspect-ratio: 1/1;
                    background-color: #c4c8e7;
                    height: 4vh;
                    border-radius: 12px;
                    margin: auto;
                    cursor: pointer;
                  "
                ></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.body.style.background =
      "linear-gradient(45deg, #000814 0%,#1d1d1d 160%)";
  </script>
  <script src="./AppData/Kits/settings.js"></script>
  <script src="./AppData/Kits/EditorBones.js"></script>
  <script src="./AppData/Kits/MiscScripts.js"></script>
  <script src="./AppData/Kits/ActionModules.js"></script>

  <script>
    setHighlightedGroup(1);
    toggleColorsVisibility();
    setTimeout(() => {
      toggleColorsVisibility();
    }, 350);
    document.body.style.padding = "0px";
    document.body.style.paddingTop = "0px";
    document.body.style.paddingBottom = "1vh";

    const interactionTools = require("./AppData/Toolkit/interactionTools.js");
    const fese = require("fs");
    try {
      fese.readFileSync(processPath + "\\AppData\\data.json", "utf8");
    } catch (err) {
      document.body.innerHTML = `<div class="flexbox" style="height: 50vh; margin-top: 24vh;">
    <div class="ring"></div>
    <div class="barbuttontexta">Hold on, Studio Bot Maker is downloading a few things!</div></div>`;
      setTimeout(() => {
        location.reload();
      }, 10000);
    }

    let lastButton;
    let pinHTML;

    async function commandData() {
      let elmd = document.getElementById("commandData");
      elmd.style.animationName = "expandFrom";
      elmd.style.animationDuration = "0.5s";
      elmd.style.height = "40%";
      elmd.style.maxHeight = "1000%";
      elmd.onclick = () => {};
      elmd.style.borderRadius = "22px";
      setTimeout(() => {
        for (let action in botData.commands[lastObj]) {
          elmd.innerHTML += `<div class="action"><div>${action}</div> - ${botData.commands[lastObj].action}</div>`;
        }
      }, 500);
    }
    let ActionTile = document.getElementById("commandbar");
    let SWT = document.getElementById("switchTask");

    let currentlyEditing = false;

    function updateName() {
      botData.commands[lastObj].name =
        document.getElementById("Command_Name").innerText;
      document.getElementById(`${lastObj}Groupname`).innerText =
        botData.commands[lastObj].name;
      wast();
    }
    try {
      ipcRenderer.send("finishLoad", {});
    } catch (err) {
      fs.writeFileSync("./errorlog.txt", err);
    }
  </script>
</html>
